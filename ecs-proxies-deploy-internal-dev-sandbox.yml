
#docker_service_cpu: 256
#docker_service_memory: 512

docker_service:
  - name: sds-api
    expose: true
    environment:
      - name: SDS_LOG_LEVEL
        value: NOTSET
      - name: SDS_MOCK_LDAP_RESPONSE
        value: "TRUE"
      - name: SDS_MOCK_LDAP_MODE
        value: "STRICT"
      - name: SDS_SPINE_CORE_ODS_CODE
        value: "YES"
      - name: CPM_PATH_URL
        value: cpm-dev-sandbox
      - name: CPM_CLIENT_KEY
        value: JrxvR6WsyTEu8BVVA1qhTbKqoktoVn0y
    secrets:
      - name: CPM_CLIENT_KEY_A
        valueFrom: "arn:aws:secretsmanager:eu-west-2:{{ PTL_ACCOUNT_ID }}:secret:ptl/spine-directory-service/cpm-apikey"
      - name: CPM_CLIENT_KEY_B
        valueFrom: "/{{ account }}/{{ service_name }}/{{ APIGEE_ENVIRONMENT }}/ptl/spine-directory-service/cpm-apikey"
      - name: GPC_CLIENT_ID
        valueFrom: "arn:aws:secretsmanager:eu-west-2:{{ PTL_ACCOUNT_ID }}:secret:ptl/gp-connect-access-record-fhir-api/gp-connect-mediation-app/CLIENT_ID_INT"
      - name: APIGEE_URL
        valueFrom: "/{{ account }}/platform-common/egress/hosts/apigee-internal-dev-sandbox"
      - name: APIGEE_URL_2
        valueFrom: "/{{ account }}/platform-common/egress/hosts/apigee-internal-dev-sandbox"
    health_check:
      matcher: "200"
      path: "/healthcheck"
